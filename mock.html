<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Counter Control</title>

<script src="https://cdn.jsdelivr.net/npm/obs-websocket-js"></script>

<style>
body {
  font-family: sans-serif;
  background: #181818;
  color: #eee;
  padding: 10px;
}
input, button {
  width: 100%;
  margin: 4px 0;
  padding: 6px;
}
button {
  cursor: pointer;
}
#status {
  margin-top: 6px;
  font-size: 0.9em;
}
.connected { color: #4caf50; }
.error { color: #f44336; }
</style>
</head>

<body>

<h3>OBS Connection</h3>

<input id="ip" placeholder="Server IP (localhost)" value="localhost">
<input id="port" placeholder="Port (4455)" value="4455">
<input id="password" type="password" placeholder="Password (optional)">

<button onclick="connect()">Connect</button>

<div id="status">Not connected</div>

<hr>

<h3>Counter</h3>

<button onclick="inc()" disabled id="incBtn">+1</button>
<button onclick="resetCounter()" disabled id="resetBtn">Reset</button>

<script>
const obs = new OBSWebSocket();
let connected = false;

function setStatus(text, className = "") {
  const s = document.getElementById("status");
  s.textContent = text;
  s.className = className;
}

async function connect() {
  const ip = document.getElementById("ip").value.trim();
  const port = document.getElementById("port").value.trim();
  const password = document.getElementById("password").value;

  const url = `ws://${ip}:${port}`;

  try {
    await obs.connect(url, password);
    connected = true;
    setStatus("Connected to OBS", "connected");
    document.getElementById("incBtn").disabled = false;
    document.getElementById("resetBtn").disabled = false;
  } catch (e) {
    setStatus("Connection failed: " + e.message, "error");
  }
}

async function inc() {
  if (!connected) return;
  await obs.call("TriggerHotkeyByName", {
    hotkeyName: "counter_inc"
  });
}

async function resetCounter() {
  if (!connected) return;
  await obs.call("TriggerHotkeyByName", {
    hotkeyName: "counter_reset"
  });
}
</script>

</body>
</html>
